var express = require('express');
var router = express.Router();
var passport = require('passport');
var csrf = require('csurf');


var csrfProtection = csrf();
router.use(csrfProtection);

router.get('/',function(req,res){
    var messages = req.flash('error');
    res.render('signup',{csrfToken: req.csrfToken(), messages: messages, hasErrors: messages.length > 0})
});


router.post('/', passport.authenticate('local.signup',{
    successRedirect: "/login",
    failureRedirect: "/signup",
    failureFlash: true
  }));


module.exports = router;